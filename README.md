# Мій власний мікросервісний проєкт  
Це репозиторій для навчального проєкту в межах курсу "DevOps CI/CD".  
## Мета  
Навчитися основам роботи з Git і GitHub.

## Урок 5 - Terraform інфраструктура на AWS

### Опис проєкту
Terraform-структура для розгортання інфраструктури на AWS з використанням модульної архітектури.

### Структура проєкту lesson-5

```
lesson-5/
│
├── main.tf                  # Головний файл для підключення модулів
├── backend.tf               # Налаштування бекенду для стейтів (S3 + DynamoDB)
├── outputs.tf               # Загальне виведення ресурсів
│
├── modules/                 # Каталог з усіма модулями
│   │
│   ├── s3-backend/          # Модуль для S3 та DynamoDB
│   │   ├── s3.tf            # Створення S3-бакета
│   │   ├── dynamodb.tf      # Створення DynamoDB
│   │   ├── variables.tf     # Змінні для S3
│   │   └── outputs.tf       # Виведення інформації про S3 та DynamoDB
│   │
│   ├── vpc/                 # Модуль для VPC
│   │   ├── vpc.tf           # Створення VPC, підмереж, Internet Gateway
│   │   ├── routes.tf        # Налаштування маршрутизації
│   │   ├── variables.tf     # Змінні для VPC
│   │   └── outputs.tf       # Виведення інформації про VPC
│   │
│   └── ecr/                 # Модуль для ECR
│       ├── ecr.tf           # Створення ECR репозиторію
│       ├── variables.tf     # Змінні для ECR
│       └── outputs.tf       # Виведення URL репозиторію ECR
```

### Команди для роботи з Terraform

#### Ініціалізація проєкту
```bash
cd lesson-5
terraform init
```

#### Планування змін
```bash
terraform plan
```

#### Застосування змін
```bash
terraform apply
```

#### Знищення інфраструктури
```bash
terraform destroy
```

### Опис модулів

#### 1. Модуль s3-backend
**Призначення**: Створення S3-бакета для зберігання Terraform state файлів та DynamoDB таблиці для блокування стейтів.

**Ресурси**:
- S3 бакет з увімкненим версіюванням
- Серверне шифрування AES256
- Блокування публічного доступу
- DynamoDB таблиця для блокування стейтів

**Змінні**:
- `bucket_name` - ім'я S3 бакета
- `table_name` - ім'я DynamoDB таблиці

#### 2. Модуль vpc
**Призначення**: Створення мережевої інфраструктури AWS.

**Ресурси**:
- VPC з CIDR блоком 10.0.0.0/16
- 3 публічні підмережі (10.0.1-3.0/24)
- 3 приватні підмережі (10.0.4-6.0/24)
- Internet Gateway для публічних підмереж
- NAT Gateway для приватних підмереж
- Route Tables для маршрутизації

**Змінні**:
- `vpc_cidr_block` - CIDR блок для VPC
- `public_subnets` - список публічних підмереж
- `private_subnets` - список приватних підмереж
- `availability_zones` - список зон доступності
- `vpc_name` - ім'я VPC

#### 3. Модуль ecr
**Призначення**: Створення ECR репозиторію для зберігання Docker образів.

**Ресурси**:
- ECR репозиторій з автоматичним скануванням образів
- Налаштування політики доступу

**Змінні**:
- `ecr_name` - ім'я ECR репозиторію
- `scan_on_push` - увімкнення сканування при push

### Особливості реалізації

1. **Унікальність імен**: S3 бакет використовує random_id для забезпечення унікального імені
2. **Регіон**: Використано eu-west-1 замість us-west-2 
3. **Безпека**: Публічний доступ до S3 заблокований, увімкнене шифрування
4. **Backend**: Налаштований S3 backend для зберігання стейт файлів з блокуванням через DynamoDB